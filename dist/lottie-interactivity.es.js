function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function n(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function r(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,function(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}(e,t,"get"))}function o(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var s=["actions","container","mode","player"],l=["actions","container","mode","player"],c="[lottieInteractivity]:",p=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,y=new WeakMap,v=new WeakMap,m=new WeakMap,f=new WeakMap,L=new WeakMap,E=new WeakMap,g=new WeakMap,w=new WeakMap,I=new WeakMap,x=new WeakMap,b=new WeakMap,k=new WeakMap,S=new WeakMap,P=new WeakMap,M=new WeakMap,C=function(){function r(t){var l=this,C=t.actions,A=t.container,T=t.mode,H=t.player,O=i(t,s);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o(this,p,{writable:!0,value:function(){if(l.player){var e=function(){l.player.addEventListener("enterFrame",a(l,g)),l.container.addEventListener("mouseenter",a(l,w)),l.container.addEventListener("mouseleave",a(l,I)),l.container.addEventListener("touchstart",a(l,w),{passive:!0}),l.container.addEventListener("touchend",a(l,I),{passive:!0})},t=function(){l.container.addEventListener("mouseenter",a(l,w)),l.container.addEventListener("mouseleave",a(l,I)),l.container.addEventListener("touchstart",a(l,w),{passive:!0}),l.container.addEventListener("touchend",a(l,I),{passive:!0})};l.stateHandler.set("loop",(function(){l.actions[l.interactionIdx].loop?l.player.loop=parseInt(l.actions[l.interactionIdx].loop)-1:l.player.loop=!0,l.player.autoplay=!0})),l.stateHandler.set("autoplay",(function(){l.player.loop=!1,l.player.autoplay=!0})),l.stateHandler.set("click",(function(){l.player.loop=!1,l.player.autoplay=!1,l.container.addEventListener("click",a(l,d))})),l.stateHandler.set("hover",(function(){l.player.loop=!1,l.player.autoplay=!1,l.container.addEventListener("mouseenter",a(l,d)),l.container.addEventListener("touchstart",a(l,d),{passive:!0})})),l.stateHandler.set("hold",t),l.stateHandler.set("pauseHold",t),l.transitionHandler.set("click",(function(){l.container.addEventListener("click",a(l,h))})),l.transitionHandler.set("hover",(function(){l.container.addEventListener("mouseenter",a(l,h)),l.container.addEventListener("touchstart",a(l,h),{passive:!0})})),l.transitionHandler.set("hold",e),l.transitionHandler.set("pauseHold",e),l.transitionHandler.set("repeat",(function(){l.player.loop=!0,l.player.autoplay=!0;l.player.addEventListener("loopComplete",(function e(){a(l,L).call(l,{handler:e})}))})),l.transitionHandler.set("onComplete",(function(){"loop"===l.actions[l.interactionIdx].state?l.player.addEventListener("loopComplete",a(l,f)):l.player.addEventListener("complete",a(l,f))})),l.transitionHandler.set("seek",(function(){l.player.stop(),l.player.addEventListener("enterFrame",a(l,E)),l.container.addEventListener("mousemove",a(l,y)),l.container.addEventListener("touchmove",a(l,v),{passive:!1}),l.container.addEventListener("mouseout",a(l,m))}))}}}),o(this,d,{writable:!0,value:function(){var e=l.actions[l.interactionIdx].forceFlag;e||!0!==l.player.isPaused?e&&a(l,b).call(l,!0):a(l,b).call(l,!0)}}),o(this,u,{writable:!0,value:function(){0===l.clickCounter?(l.player.play(),l.clickCounter++):(l.clickCounter++,l.player.setDirection(-1*l.player.playDirection),l.player.play())}}),o(this,h,{writable:!0,value:function(){var e=l.actions[l.interactionIdx].forceFlag,t=l.actions[l.interactionIdx].state,n=l.actions[l.interactionIdx].transition;if("chain"===l.mode){if(l.actions[l.interactionIdx].count){var i=parseInt(l.actions[l.interactionIdx].count);if(l.clickCounter<i-1)return void(l.clickCounter+=1)}return l.clickCounter=0,!e&&"click"===n&&"click"===t||"hover"===n&&"hover"===t?l.transitionHandler.get("onComplete").call():l.nextInteraction(),l.container.removeEventListener("click",a(l,h)),void l.container.removeEventListener("mouseenter",a(l,h))}e||!0!==l.player.isPaused?e&&l.player.goToAndPlay(0,!0):l.player.goToAndPlay(0,!0)}}),o(this,y,{writable:!0,value:function(e){a(l,P).call(l,e.clientX,e.clientY)}}),o(this,v,{writable:!0,value:function(e){e.cancelable&&e.preventDefault(),a(l,P).call(l,e.touches[0].clientX,e.touches[0].clientY)}}),o(this,m,{writable:!0,value:function(){a(l,P).call(l,-1,-1)}}),o(this,f,{writable:!0,value:function(){"loop"===l.actions[l.interactionIdx].state?l.player.removeEventListener("loopComplete",a(l,f)):l.player.removeEventListener("complete",a(l,f)),l.nextInteraction()}}),o(this,L,{writable:!0,value:function(e){var t=e.handler,n=1;l.actions[l.interactionIdx].repeat&&(n=l.actions[l.interactionIdx].repeat),l.playCounter>=n-1?(l.playCounter=0,l.player.removeEventListener("loopComplete",t),l.player.loop=!1,l.player.autoplay=!1,l.nextInteraction()):l.playCounter+=1}}),o(this,E,{writable:!0,value:function(){var e=l.actions[l.interactionIdx].frames;e&&l.player.currentFrame>=parseInt(e[1])-1&&(l.player.removeEventListener("enterFrame",a(l,E)),l.container.removeEventListener("mousemove",a(l,y)),l.container.removeEventListener("mouseout",a(l,m)),setTimeout(l.nextInteraction,0))}}),o(this,g,{writable:!0,value:function(){var e=l.actions[l.interactionIdx].frames;(e&&l.player.currentFrame>=e[1]||l.player.currentFrame>=l.player.totalFrames-1)&&(l.player.removeEventListener("enterFrame",a(l,g)),l.container.removeEventListener("mouseenter",a(l,w)),l.container.removeEventListener("mouseleave",a(l,I)),l.container.removeEventListener("touchstart",a(l,w),{passive:!0}),l.container.removeEventListener("touchend",a(l,I),{passive:!0}),l.player.pause(),l.holdStatus=!1,l.nextInteraction()),-1===l.player.playDirection&&e&&l.player.currentFrame<e[0]&&l.player.pause()}}),o(this,w,{writable:!0,value:function(){-1!==l.player.playDirection&&null!==l.holdStatus&&l.holdStatus||(l.player.setDirection(1),l.player.play(),l.holdStatus=!0)}}),o(this,I,{writable:!0,value:function(){"hold"===l.actions[l.interactionIdx].transition||"hold"===l.actions[l.interactionIdx].state||"hold"===l.actions[0].type?(l.player.setDirection(-1),l.player.play()):"pauseHold"!==l.actions[l.interactionIdx].transition&&"pauseHold"!==l.actions[l.interactionIdx].state&&"pauseHold"!==l.actions[0].type||l.player.pause(),l.holdStatus=!1}}),o(this,x,{writable:!0,value:function(){if(l.container.removeEventListener("click",a(l,h)),l.container.removeEventListener("click",a(l,d)),l.container.removeEventListener("mouseenter",a(l,h)),l.container.removeEventListener("touchstart",a(l,h)),l.container.removeEventListener("touchmove",a(l,v)),l.container.removeEventListener("mouseenter",a(l,d)),l.container.removeEventListener("touchstart",a(l,d)),l.container.removeEventListener("mouseenter",a(l,w)),l.container.removeEventListener("touchstart",a(l,w)),l.container.removeEventListener("mouseleave",a(l,I)),l.container.removeEventListener("mousemove",a(l,y)),l.container.removeEventListener("mouseout",a(l,m)),l.container.removeEventListener("touchend",a(l,I)),l.player)try{l.player.removeEventListener("loopComplete",a(l,f)),l.player.removeEventListener("complete",a(l,f)),l.player.removeEventListener("enterFrame",a(l,E)),l.player.removeEventListener("enterFrame",a(l,g))}catch(e){}}}),n(this,"jumpToInteraction",(function(e){a(l,x).call(l),l.interactionIdx=e,l.interactionIdx<0?l.interactionIdx=0:l.interactionIdx,l.nextInteraction(!1)})),n(this,"nextInteraction",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];l.oldInterctionIdx=l.interactionIdx,a(l,x).call(l),l.player.loop=!1;var t=l.actions[l.interactionIdx].jumpTo;t?t>=0&&t<l.actions.length?(l.interactionIdx=t,a(l,S).call(l,{ignorePath:!1})):(l.interactionIdx=0,l.player.goToAndStop(0,!0),a(l,S).call(l,{ignorePath:!1})):(e&&l.interactionIdx++,l.interactionIdx>=l.actions.length?l.actions[l.actions.length-1].reset?(l.interactionIdx=0,l.player.resetSegments(!0),l.actions[l.interactionIdx].frames?l.player.goToAndStop(l.actions[l.interactionIdx].frames,!0):l.player.goToAndStop(0,!0),a(l,S).call(l,{ignorePath:!1})):(l.interactionIdx=l.actions.length-1,a(l,S).call(l,{ignorePath:!1})):a(l,S).call(l,{ignorePath:!1})),l.container.dispatchEvent(new CustomEvent("transition",{bubbles:!0,composed:!0,detail:{oldIndex:l.oldInterctionIdx,newIndex:l.interactionIdx}}))})),o(this,b,{writable:!0,value:function(e){var t=l.actions[l.interactionIdx].frames;if(!t)return l.player.resetSegments(!0),void l.player.goToAndPlay(0,!0);"string"==typeof t?l.player.goToAndPlay(t,e):l.player.playSegments(t,e)}}),o(this,k,{writable:!0,value:function(){var t=l.actions[l.interactionIdx].path;if(!t)if("object"===e(l.enteredPlayer)&&"AnimationItem"===l.enteredPlayer.constructor.name){if(t=l.enteredPlayer,l.player===t)return void a(l,S).call(l,{ignorePath:!0})}else{var n=(t=l.loadedAnimation).substr(t.lastIndexOf("/")+1);if(n=n.substr(0,n.lastIndexOf(".json")),l.player.fileName===n)return void a(l,S).call(l,{ignorePath:!0})}var i=l.container.getBoundingClientRect(),r="width: "+i.width+"px !important; height: "+i.height+"px !important; background: "+l.container.style.background;if(l.container.setAttribute("style",r),"object"!==e(l.enteredPlayer)||"AnimationItem"!==l.enteredPlayer.constructor.name){if("string"==typeof l.enteredPlayer){var o=document.querySelector(l.enteredPlayer);o&&"LOTTIE-PLAYER"===o.nodeName&&(l.attachedListeners||(o.addEventListener("ready",(function(){l.container.style.width="",l.container.style.height=""})),o.addEventListener("load",(function(){l.player=o.getLottie(),a(l,S).call(l,{ignorePath:!0})})),l.attachedListeners=!0),o.load(t))}else l.enteredPlayer instanceof HTMLElement&&"LOTTIE-PLAYER"===l.enteredPlayer.nodeName&&(l.attachedListeners||(l.enteredPlayer.addEventListener("ready",(function(){l.container.style.width="",l.container.style.height=""})),l.enteredPlayer.addEventListener("load",(function(){l.player=l.enteredPlayer.getLottie(),a(l,S).call(l,{ignorePath:!0})})),l.attachedListeners=!0),l.enteredPlayer.load(t));if(!l.player)throw new Error("".concat(c," Specified player is invalid."),l.enteredPlayer)}else{if(!window.lottie)throw new Error("".concat(c," A Lottie player is required."));l.stop(),l.container.innerHTML="","object"===e(t)&&"AnimationItem"===t.constructor.name?l.player=window.lottie.loadAnimation({loop:!1,autoplay:!1,animationData:t.animationData,container:l.container}):l.player=window.lottie.loadAnimation({loop:!1,autoplay:!1,path:t,container:l.container}),l.player.addEventListener("DOMLoaded",(function(){l.container.style.width="",l.container.style.height="",a(l,S).call(l,{ignorePath:!0})}))}l.clickCounter=0,l.playCounter=0}}),o(this,S,{writable:!0,value:function(e){var t=e.ignorePath,n=l.actions[l.interactionIdx].frames,i=l.actions[l.interactionIdx].state,r=l.actions[l.interactionIdx].transition,o=l.actions[l.interactionIdx].path,s=l.stateHandler.get(i),c=l.transitionHandler.get(r),p=l.actions[l.interactionIdx].speed?l.actions[l.interactionIdx].speed:1,d=l.actions[l.interactionIdx].delay?l.actions[l.interactionIdx].delay:0;t||!(o||l.actions[l.actions.length-1].reset&&0===l.interactionIdx)?setTimeout((function(){n&&(l.player.autoplay=!1,l.player.resetSegments(!0),l.player.goToAndStop(n[0],!0)),s?s.call():"none"===i&&(l.player.loop=!1,l.player.autoplay=!1),c&&c.call(),l.player.autoplay&&(l.player.resetSegments(!0),a(l,b).call(l,!0)),l.player.setSpeed(p)}),d):a(l,k).call(l)}}),o(this,P,{writable:!0,value:function(e,t){if(-1!==e&&-1!==t){var n=l.getContainerCursorPosition(e,t);e=n.x,t=n.y}var i=l.actions.find((function(n){var i=n.position;if(i){if(Array.isArray(i.x)&&Array.isArray(i.y))return e>=i.x[0]&&e<=i.x[1]&&t>=i.y[0]&&t<=i.y[1];if(!Number.isNaN(i.x)&&!Number.isNaN(i.y))return e===i.x&&t===i.y}return!1}));if(i)if("seek"===i.type||"seek"===i.transition){var r=(e-i.position.x[0])/(i.position.x[1]-i.position.x[0]),a=(t-i.position.y[0])/(i.position.y[1]-i.position.y[0]);l.player.playSegments(i.frames,!0),i.position.y[0]<0&&i.position.y[1]>1?l.player.goToAndStop(Math.floor(r*l.player.totalFrames),!0):l.player.goToAndStop(Math.ceil((r+a)/2*l.player.totalFrames),!0)}else"loop"===i.type?l.player.playSegments(i.frames,!0):"play"===i.type?(!0===l.player.isPaused&&l.player.resetSegments(),l.player.playSegments(i.frames)):"stop"===i.type&&(l.player.resetSegments(!0),l.player.goToAndStop(i.frames[0],!0))}}),o(this,M,{writable:!0,value:function(){var e=l.getContainerVisibility(),t=l.actions.find((function(t){var n=t.visibility;return e>=n[0]&&e<=n[1]}));if(t)if("seek"===t.type){var n=t.frames[0],i=2==t.frames.length?t.frames[1]:l.player.totalFrames-1;null!==l.assignedSegment&&(l.player.resetSegments(!0),l.assignedSegment=null),l.player.goToAndStop(n+Math.round((e-t.visibility[0])/(t.visibility[1]-t.visibility[0])*(i-n)),!0)}else if("loop"===t.type)l.player.loop=!0,(null===l.assignedSegment||l.assignedSegment!==t.frames||!0===l.player.isPaused)&&(l.player.playSegments(t.frames,!0),l.assignedSegment=t.frames);else if("play"===t.type||"playOnce"===t.type){if("playOnce"===t.type&&!l.scrolledAndPlayed)return l.scrolledAndPlayed=!0,l.player.resetSegments(!0),void(t.frames?l.player.playSegments(t.frames,!0):l.player.play());"play"===t.type&&l.player.isPaused&&(l.player.resetSegments(!0),t.frames?l.player.playSegments(t.frames,!0):l.player.play())}else"stop"===t.type&&l.player.goToAndStop(t.frames[0],!0)}}),this.enteredPlayer=H,"object"!==e(H)||"AnimationItem"!==H.constructor.name){if("string"==typeof H){var j=document.querySelector(H);j&&"LOTTIE-PLAYER"===j.nodeName&&(H=j.getLottie())}else H instanceof HTMLElement&&"LOTTIE-PLAYER"===H.nodeName&&(H=H.getLottie());if(!H)throw new Error(c+"Specified player:"+H+" is invalid.")}"string"==typeof A&&(A=document.querySelector(A)),A||(A=H.wrapper),this.player=H,this.loadedAnimation=this.player.path+this.player.fileName+".json",this.attachedListeners=!1,this.container=A,this.mode=T,this.actions=C,this.options=O,this.assignedSegment=null,this.scrolledAndPlayed=!1,this.interactionIdx=0,this.oldInterctionIdx=0,this.clickCounter=0,this.playCounter=0,this.stateHandler=new Map,this.transitionHandler=new Map}var C,A,T;return C=r,(A=[{key:"getContainerVisibility",value:function(){var e=this.container.getBoundingClientRect(),t=e.top,n=e.height;return(window.innerHeight-t)/(window.innerHeight+n)}},{key:"getContainerCursorPosition",value:function(e,t){var n=this.container.getBoundingClientRect(),i=n.top;return{x:(e-n.left)/n.width,y:(t-i)/n.height}}},{key:"initScrollMode",value:function(){this.player.stop(),window.addEventListener("scroll",a(this,M),!0)}},{key:"initCursorMode",value:function(){this.actions&&1===this.actions.length?"click"===this.actions[0].type?(this.player.loop=!1,this.player.stop(),this.container.addEventListener("click",a(this,h))):"hover"===this.actions[0].type?(this.player.loop=!1,this.player.stop(),this.container.addEventListener("mouseenter",a(this,h)),this.container.addEventListener("touchstart",a(this,h),{passive:!0})):"toggle"===this.actions[0].type?(this.player.loop=!1,this.player.stop(),this.container.addEventListener("click",a(this,u))):"hold"===this.actions[0].type||"pauseHold"===this.actions[0].type?(this.container.addEventListener("mouseenter",a(this,w)),this.container.addEventListener("mouseleave",a(this,I)),this.container.addEventListener("touchstart",a(this,w),{passive:!0}),this.container.addEventListener("touchend",a(this,I),{passive:!0})):"seek"===this.actions[0].type&&(this.player.loop=!0,this.player.stop(),this.container.addEventListener("mousemove",a(this,y)),this.container.addEventListener("touchmove",a(this,v),{passive:!1}),this.container.addEventListener("mouseout",a(this,m))):(this.player.loop=!0,this.player.stop(),this.container.addEventListener("mousemove",a(this,y)),this.container.addEventListener("mouseleave",a(this,m)),a(this,P).call(this,-1,-1))}},{key:"initChainMode",value:function(){a(this,p).call(this),this.player.loop=!1,this.player.stop(),a(this,S).call(this,{ignorePath:!1})}},{key:"start",value:function(){var e=this;"scroll"===this.mode?this.player.isLoaded?this.initScrollMode():this.player.addEventListener("DOMLoaded",(function(){e.initScrollMode()})):"cursor"===this.mode?this.player.isLoaded?this.initCursorMode():this.player.addEventListener("DOMLoaded",(function(){e.initCursorMode()})):"chain"===this.mode&&(this.player.isLoaded?this.initChainMode():this.player.addEventListener("DOMLoaded",(function(){e.initChainMode()})))}},{key:"redefineOptions",value:function(t){var n=t.actions,r=t.container,a=t.mode,o=t.player,s=i(t,l);if(this.stop(),this.enteredPlayer=o,"object"!==e(o)||"AnimationItem"!==o.constructor.name){if("string"==typeof o){var p=document.querySelector(o);p&&"LOTTIE-PLAYER"===p.nodeName&&(o=p.getLottie())}else o instanceof HTMLElement&&"LOTTIE-PLAYER"===o.nodeName&&(o=o.getLottie());if(!o)throw new Error(c+"Specified player:"+o+" is invalid.",o)}"string"==typeof r&&(r=document.querySelector(r)),r||(r=o.wrapper),this.player=o,this.loadedAnimation=this.player.path+this.player.fileName+".json",this.attachedListeners=!1,this.container=r,this.mode=a,this.actions=n,this.options=s,this.assignedSegment=null,this.scrolledAndPlayed=!1,this.interactionIdx=0,this.clickCounter=0,this.playCounter=0,this.holdStatus=null,this.stateHandler=new Map,this.transitionHandler=new Map,this.start()}},{key:"stop",value:function(){if("scroll"===this.mode&&window.removeEventListener("scroll",a(this,M),!0),"cursor"===this.mode&&(this.container.removeEventListener("click",a(this,h)),this.container.removeEventListener("click",a(this,u)),this.container.removeEventListener("mouseenter",a(this,h)),this.container.removeEventListener("touchstart",a(this,h)),this.container.removeEventListener("touchmove",a(this,v)),this.container.removeEventListener("mousemove",a(this,y)),this.container.removeEventListener("mouseleave",a(this,m)),this.container.removeEventListener("touchstart",a(this,w)),this.container.removeEventListener("touchend",a(this,I))),"chain"===this.mode&&(this.container.removeEventListener("click",a(this,h)),this.container.removeEventListener("click",a(this,d)),this.container.removeEventListener("mouseenter",a(this,h)),this.container.removeEventListener("touchstart",a(this,h)),this.container.removeEventListener("touchmove",a(this,v)),this.container.removeEventListener("mouseenter",a(this,d)),this.container.removeEventListener("touchstart",a(this,d)),this.container.removeEventListener("mouseenter",a(this,w)),this.container.removeEventListener("touchstart",a(this,w)),this.container.removeEventListener("mouseleave",a(this,I)),this.container.removeEventListener("mousemove",a(this,y)),this.container.removeEventListener("mouseout",a(this,m)),this.container.removeEventListener("touchend",a(this,I)),this.player))try{this.player.removeEventListener("loopComplete",a(this,f)),this.player.removeEventListener("complete",a(this,f)),this.player.removeEventListener("enterFrame",a(this,E)),this.player.removeEventListener("enterFrame",a(this,g))}catch(e){}this.player&&(this.player.destroy(),this.player=null)}}])&&t(C.prototype,A),T&&t(C,T),Object.defineProperty(C,"prototype",{writable:!1}),r}(),A=function(e){var t=new C(e);return t.start(),t};export{C as LottieInteractivity,A as create,A as default};
//# sourceMappingURL=lottie-interactivity.es.js.map
